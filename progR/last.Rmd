---
title: "Analyse des jeux vidéo 2024 sur Grouvee"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Chargement des bibliothèques nécessaires
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(stringr)
library(treemapify)
library(forcats)
library(scales)
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(stringr)
library(treemapify)
library(cluster)
library(factoextra)
library(lubridate)
library(reshape2)
```


# Analyse complète des jeux vidéo 2024 sur Grouvee

```{r}
# Chargement des données
df <- read_delim("grouvee_2024_games.csv", delim = ";", locale = locale(encoding = "Latin1"), show_col_types = FALSE)


# Conversion explicite de la colonne Note Moyenne en numérique
df$`Note Moyenne` <- as.numeric(df$`Note Moyenne`)

# Aperçu rapide
glimpse(df)

```


```{r}
# ---------------------------
# 1. Tendance générale des notes
# ---------------------------
# Chargement des données
df <- read_delim("grouvee_2024_games.csv", delim = ";", locale = locale(encoding = "Latin1"), show_col_types = FALSE)

# Nettoyage : convertir les virgules en points puis transformer en numérique
df$`Note Moyenne` <- as.numeric(gsub(",", ".", df$`Note Moyenne`))


# Filtrer uniquement les jeux notés (note > 0)
df_notes <- df %>% filter(`Note Moyenne` > 0)

# Histogramme de la distribution des notes
ggplot(df_notes, aes(x = `Note Moyenne`)) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "white") +
  labs(title = "Distribution des notes moyennes des jeux", x = "Note Moyenne", y = "Nombre de jeux") +
  theme_minimal()

# Boxplot des notes valides
ggplot(df_notes, aes(y = `Note Moyenne`)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(title = "Boxplot des notes moyennes (hors jeux non notés)", y = "Note Moyenne") +
  theme_minimal()

# Courbe de densité des notes
ggplot(df_notes, aes(x = `Note Moyenne`)) +
  geom_density(fill = "orange", alpha = 0.5, color = "black") +
  labs(title = "Courbe de densité des notes moyennes", x = "Note Moyenne", y = "Densité") +
  theme_minimal()
```

```{r}
cat("Analyse :

    La courbe présente plusieurs pics de densité, indiquant que les notes se regroupent autour de certaines valeurs spécifiques.

    Les trois principaux pics se situent autour de 2, 3, et 4, ce qui indique une distribution multimodale.

    Cela signifie que les utilisateurs sont partagés : certains jeux sont mal notés, d’autres très bien.

    La distribution n’est pas normale, ce qui peut traduire des expériences utilisateurs très contrastées.")
```


```{r}
# ---------------------------
# 2. Comparaison des genres
# ---------------------------

df_genres <- df %>%
  filter(!is.na(Genres) & Genres != "") %>%
  separate_rows(Genres, sep = ",\\s*")

genre_summary <- df_genres %>%
  filter(`Note Moyenne` > 0) %>%
  group_by(Genres) %>%
  summarise(Note_Moyenne = mean(`Note Moyenne`, na.rm=TRUE), Nombre_jeux = n(), .groups = "drop") %>%
  arrange(desc(Note_Moyenne))

# Boxplot par genre
ggplot(df_genres %>% filter(`Note Moyenne` > 0), aes(x = Genres, y = `Note Moyenne`)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "Boxplot des notes par genre", x = "Genre", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Barre des moyennes par genre
ggplot(genre_summary, aes(x = reorder(Genres, -Note_Moyenne), y = Note_Moyenne)) +
  geom_col(fill = "darkgreen") +
  geom_text(aes(label = round(Note_Moyenne, 2)), vjust = -0.5) +
  labs(title = "Note moyenne par genre", x = "Genre", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
# ---------------------------
# 3. Plateformes et notes
# ---------------------------

df_platforms <- df %>%
  filter(!is.na(Plateformes) & Plateformes != "") %>%
  separate_rows(Plateformes, sep = ",\\s*")

platform_summary <- df_platforms %>%
  filter(`Note Moyenne` > 0) %>%
  group_by(Plateformes) %>%
  summarise(Note_Moyenne = mean(`Note Moyenne`, na.rm=TRUE), Nombre_jeux = n(), .groups = "drop") %>%
  arrange(desc(Note_Moyenne))

# Boxplot par plateforme
ggplot(df_platforms %>% filter(`Note Moyenne` > 0), aes(x = Plateformes, y = `Note Moyenne`)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Répartition des notes par plateforme", x = "Plateforme", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Moyenne par plateforme
ggplot(platform_summary, aes(x = reorder(Plateformes, -Note_Moyenne), y = Note_Moyenne)) +
  geom_col(fill = "darkorange") +
  geom_text(aes(label = round(Note_Moyenne, 2)), vjust = -0.5) +
  labs(title = "Note moyenne par plateforme", x = "Plateforme", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



```{r clustering-avec-labels, echo=TRUE, message=FALSE, warning=FALSE}
# ---------------------------
# 4. Clustering
# ---------------------------
# Charger les packages nécessaires
library(dplyr)
library(stringr)
library(ggplot2)
library(ggrepel)     # Pour geom_text_repel
library(factoextra)  # Pour fviz_cluster

# Préparer les données de clustering en gardant la colonne Titre pour les étiquettes
df_clust_all <- df %>%
  filter(`Note Moyenne` > 0 & !is.na(Plateformes)) %>%
  mutate(nb_plateformes = str_count(Plateformes, ",") + 1) %>%
  select(Titre, `Note Moyenne`, nb_plateformes)

# Mise à l'échelle des données numériques pour le clustering
df_clust_scaled <- scale(df_clust_all %>% select(`Note Moyenne`, nb_plateformes))

# Exécuter le clustering k-means avec 3 clusters
kmeans_result <- kmeans(df_clust_scaled, centers = 3, nstart = 25)

# Visualisation de base du clustering avec fviz_cluster
cluster_plot <- fviz_cluster(
  object = kmeans_result,
  data   = df_clust_scaled,
  geom   = "point",         # Tracer les points
  ellipse.type = "convex",  # Afficher l'enveloppe convexe des clusters
  label  = "none",          # Pas de labels automatiques
  ggtheme = theme_minimal(),
  main   = "Clustering des jeux"
)

# Ajouter les étiquettes manuellement avec geom_text_repel pour éviter le chevauchement
cluster_plot + 
  geom_text_repel(
    aes(
      x = cluster_plot$data$x,
      y = cluster_plot$data$y,
      label = df_clust_all$Titre
    ),
    size = 2,         # Taille du texte
    max.overlaps = 20 # Limite le chevauchement des labels
  )
```



```{r}
# ---------------------------
# 5. Corrélation
# ---------------------------

# Filtrer les jeux notés (Note Moyenne > 0) et extraire nb_plateformes
df_corr <- df %>%
  filter(`Note Moyenne` > 0 & !is.na(Plateformes)) %>%
  mutate(nb_plateformes = str_count(Plateformes, ",") + 1) %>%
  select(`Note Moyenne`, nb_plateformes)

# Calcul de la matrice de corrélation (seulement 2 variables ici)
cor_matrix <- cor(df_corr, use = "complete.obs")

# Transformation de la matrice de corrélation au format long
melted_corr <- melt(cor_matrix)

# Création de la heatmap
ggplot(melted_corr, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  geom_text(aes(label = round(value, 2)), color = "black") + # Pour afficher la valeur numérique
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
  labs(
    title = "Matrice de corrélation",
    x = NULL, 
    y = NULL
  ) +
  theme_minimal()
```


```{r}
# ---------------------------
# 8. Franchises
# ---------------------------

# Importer les données avec la colonne "Note Moyenne" en texte
df <- read_delim("grouvee_2024_games.csv", delim = ";", locale = locale(encoding = "Latin1"), col_types = cols(`Note Moyenne` = col_character()), show_col_types = FALSE)

# Correction : Remplacer les virgules par des points et convertir en numérique
df$`Note Moyenne` <- as.numeric(gsub(",", ".", df$`Note Moyenne`))

# Créer une nouvelle variable "Avec_Franchise" :
# Si la colonne Franchise est vide ou NA, on considère que le jeu est "Sans Franchise", sinon "Avec Franchise"
df_franchise <- df %>%
  mutate(Avec_Franchise = if_else(is.na(Franchise) | Franchise == "", "Sans Franchise", "Avec Franchise")) %>%
  filter(`Note Moyenne` > 0)  # Ne conserver que les jeux notés (> 0)

# Vérification rapide
str(df$`Note Moyenne`)
summary(df$`Note Moyenne`)

# Boxplot comparatif des notes selon l'appartenance à une franchise
ggplot(df_franchise, aes(x = Avec_Franchise, y = `Note Moyenne`)) +
  geom_boxplot(fill = "mediumpurple") +
  labs(title = "Comparaison des notes avec ou sans franchise",
       x = "Franchise", y = "Note Moyenne") +
  theme_minimal()

```

```{r}
# ---------------------------
# 9. Régression linéaire
# ---------------------------

df_reg <- df %>%
  filter(`Note Moyenne` > 0 & !is.na(Plateformes)) %>%
  mutate(nb_plateformes = str_count(Plateformes, ",") + 1)

modele <- lm(`Note Moyenne` ~ nb_plateformes, data = df_reg)
summary(modele)

# Graphique
ggplot(df_reg, aes(x = nb_plateformes, y = `Note Moyenne`)) +
  geom_point(color = "blue", alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Régression : Note Moyenne vs Nombre de plateformes") +
  theme_minimal()
```


```{r}
#Analyse :
cat("Le graphique montre une légère corrélation positive entre le nombre de plateformes et la note moyenne des jeux. Les jeux disponibles sur plusieurs plateformes tendent à obtenir de meilleures notes, bien que cette tendance reste modérée. Une forte dispersion des données suggère que d'autres facteurs influencent aussi la qualité perçue. Ce résultat indique que la portée multiplateforme peut être un avantage, mais n’est pas un gage de succès.")
```