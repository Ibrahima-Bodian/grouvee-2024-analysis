# Chargement des packages
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)

# ðŸ”¹ Charger le fichier (en adaptant le chemin si besoin)
df <- read_csv("grouvee_2024_games.csv", locale = locale(encoding = "UTF-8"))

# ðŸ”¹ Nettoyage : enlever les NA dans Plateformes, et sÃ©parer les plateformes multiples
df_clean <- df %>%
  filter(!is.na(Plateformes)) %>%
  separate_rows(Plateformes, sep = ",\\s*")  # SÃ©pare en lignes

# ðŸ”¹ Filtrage des notes valides (> 0)
df_clean$`Note Moyenne` <- as.numeric(df_clean$`Note Moyenne`)
df_clean_valid <- df_clean %>% filter(`Note Moyenne` > 0)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ðŸ“Š 1. Histogramme : Nombre de jeux par plateforme
ggplot(df_clean, aes(x = Plateformes)) +
  geom_bar(fill = "steelblue") +
  labs(title = "                 Nombre de jeux par plateforme",
       x = "Plateforme", y = "Nombre de jeux") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


ggplot(df_clean, aes(x = Plateformes)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5, size = 3) +  # Ajout des Ã©tiquettes
  labs(title = "                 Nombre de jeux par plateforme",
       x = "Plateforme", y = "Nombre de jeux") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ðŸ“Š 2. Moyenne des notes par plateforme
df_avg <- df_clean_valid %>%
  group_by(Plateformes) %>%
  summarise(Note_Moyenne = round(mean(`Note Moyenne`, na.rm = TRUE), 2),
            n_jeux = n()) %>%
  arrange(desc(Note_Moyenne))

ggplot(df_avg, aes(x = reorder(Plateformes, -Note_Moyenne), y = Note_Moyenne)) +
  geom_col(fill = "darkorange") +
  geom_text(aes(label = Note_Moyenne), vjust = -0.3, size = 3.5) +
  labs(title = "Note moyenne des jeux par plateforme",
       x = "Plateforme", y = "Note moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


library(ggplot2)
library(dplyr)
library(stringr)

# Compter le nombre de plateformes par jeu
df$nb_plateformes <- str_count(df$Plateformes, ",") + 1

# Filtrer les jeux avec une note > 0
df_filtered <- df %>%
  filter(`Note Moyenne` > 0)

# Nuage de points
ggplot(df_filtered, aes(x = nb_plateformes, y = `Note Moyenne`)) +
  geom_point(color = "steelblue", alpha = 0.6, size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "darkred") +
  labs(title = "        Note moyenne vs Nombre de plateformes",
       x = "Nombre de plateformes",
       y = "Note Moyenne") +
  theme_minimal()



library(tidyverse)

# SÃ©parer les plateformes multiples
df_platforms <- df %>%
  separate_rows(Plateformes, sep = ",\\s*") %>%
  filter(!is.na(Plateformes), Plateformes != "")

# Compter les jeux par plateforme
platform_counts <- df_platforms %>%
  count(Plateformes, name = "Nombre_Jeux") %>%
  arrange(desc(Nombre_Jeux))

# CrÃ©er le graphique
ggplot(platform_counts, aes(x = reorder(Plateformes, Nombre_Jeux), y = Nombre_Jeux)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  geom_text(aes(label = Nombre_Jeux), vjust = -0.5, size = 3) +  # âž• Ajout des Ã©tiquettes
  labs(title = "                                  Nombre de jeux par plateforme",
       x = "Plateforme", y = "Nombre de jeux") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


#--------------------------------------------
library(ggplot2)
library(dplyr)
library(tidyr)

df_genres <- df_clean %>%
  filter(!is.na(Genres)) %>%
  separate_rows(Genres, sep = ",\\s*") %>%
  group_by(Genres) %>%
  summarise(Nombre_jeux = n()) %>%
  arrange(desc(Nombre_jeux)) %>%
  mutate(pct = round(Nombre_jeux / sum(Nombre_jeux) * 100, 1),
         label = paste0(Genres, " (", pct, "%)"))

ggplot(df_genres, aes(x = "", y = Nombre_jeux, fill = Genres)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 3) +
  labs(title = "RÃ©partition des jeux par genre") +
  theme_void()


ggplot(df_genres, aes(x = reorder(Genres, Nombre_jeux), y = Nombre_jeux)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = Nombre_jeux), hjust = -0.1, size = 3.5) +
  coord_flip() +
  labs(title = "Nombre de jeux par genre", x = "Genre", y = "Nombre de jeux") +
  theme_minimal()




# Assurez-vous d'avoir le package
#install.packages("treemapify")  # Ã  faire une seule fois si pas encore installÃ©
library(treemapify)
library(ggplot2)
library(dplyr)
library(tidyr)

# Charger vos donnÃ©es (adapter le chemin si besoin)
df <- read.csv("grouvee_2024_games.csv", sep = ";", encoding = "UTF-8")

# Nettoyage et prÃ©paration des genres
df_genres <- df %>%
  filter(!is.na(Genres) & Genres != "") %>%
  separate_rows(Genres, sep = ",\\s*") %>%
  group_by(Genres) %>%
  summarise(Nombre_jeux = n(), .groups = "drop") %>%
  arrange(desc(Nombre_jeux))

# Treemap
ggplot(df_genres, aes(area = Nombre_jeux, fill = Genres, label = paste0(Genres, "\n", Nombre_jeux))) +
  geom_treemap() +
  geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
  labs(title = "RÃ©partition des jeux par genre (Treemap)") +
  theme_minimal()


#-----------------------------------------------------#
# Analyse de la tendance gÃ©nÃ©rale des notes
#1. Histogramme des notes
ggplot(df_clean, aes(x = as.numeric(`Note Moyenne`))) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "white") +
  labs(title = "       Distribution des notes moyennes des jeux",
       x = "Note Moyenne", y = "Nombre de jeux") +
  theme_minimal()

#2. Boxplot global
ggplot(df_clean, aes(y = as.numeric(`Note Moyenne`))) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "                        RÃ©partition globale des notes moyennes",
       y = "Note Moyenne") +
  theme_minimal()

#3. Courbe de densitÃ©
ggplot(df_clean, aes(x = as.numeric(`Note Moyenne`))) +
  geom_density(fill = "orange", alpha = 0.5) +
  labs(title = "              Courbe de densitÃ© des notes moyennes", x = "Note Moyenne", y="DensitÃ©") +
  theme_minimal()


summary(df_clean$`Note Moyenne`)
sd(df_clean$`Note Moyenne`, na.rm = TRUE)



#-----------------------------
# Impact de la plateforme sur la note

# Nettoyage : on ne garde que les jeux ayant une note
df_notes <- df_clean %>%
  filter(`Note Moyenne` > 0 & !is.na(Plateformes))

# SÃ©parer les plateformes multiples
df_notes_sep <- df_notes %>%
  separate_rows(Plateformes, sep = ",\\s*")  # SÃ©pare par virgule + espace

# Calcul de la moyenne par plateforme
df_notes_platform <- df_notes_sep %>%
  group_by(Plateformes) %>%
  summarise(Note_Moyenne = mean(`Note Moyenne`, na.rm = TRUE),
            Nombre_jeux = n()) %>%
  arrange(desc(Note_Moyenne))


#Graphique 1 : Moyenne des notes par plateforme
ggplot(df_notes_platform, aes(x = reorder(Plateformes, Note_Moyenne), y = Note_Moyenne)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = round(Note_Moyenne, 2)), vjust = -0.3, size = 3) +
  labs(title = "Note moyenne des jeux par plateforme",
       x = "Plateforme", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



ggplot(df_notes_sep, aes(x = Plateformes, y = `Note Moyenne`)) +
  geom_boxplot(fill = "lightgreen") +
  labs(title = "VariabilitÃ© des notes moyennes par plateforme",
       x = "Plateforme", y = "Note Moyenne") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

